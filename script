-- ‚úÖ –ü–æ–ª–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è Roblox Mobile UI —Å ESP (Box, Name, Skeleton)
-- –ê–≤—Ç–æ—Ä: mellontyX1

local Players = game:GetService("Players")
local player = Players.LocalPlayer
local camera = workspace.CurrentCamera
local uis = game:GetService("UserInputService")
local rs = game:GetService("RunService")

local espToggles = {
	Enabled = false,
	Box = false,
	Name = false,
	Skeleton = false,
}

local drawings = {}

-- üß† –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è ESP –æ–±—ä–µ–∫—Ç–∞
local function createESP(player)
	if drawings[player] then return end
	drawings[player] = {
		Box = Drawing.new("Square"),
		Name = Drawing.new("Text"),
		Lines = {},
	}

	drawings[player].Box.Thickness = 1
	drawings[player].Box.Color = Color3.fromRGB(255, 50, 50)
	drawings[player].Box.Transparency = 1
	drawings[player].Box.Filled = false
	drawings[player].Box.Visible = false

	drawings[player].Name.Size = 13
	drawings[player].Name.Center = true
	drawings[player].Name.Outline = true
	drawings[player].Name.Color = Color3.fromRGB(255, 255, 255)
	drawings[player].Name.Transparency = 1
	drawings[player].Name.Visible = false

	for i = 1, 5 do
		table.insert(drawings[player].Lines, Drawing.new("Line"))
		drawings[player].Lines[i].Color = Color3.fromRGB(0, 255, 255)
		drawings[player].Lines[i].Thickness = 1
		drawings[player].Lines[i].Transparency = 1
		drawings[player].Lines[i].Visible = false
	end
end

-- üßπ –£–¥–∞–ª–∏—Ç—å ESP
local function removeESP(player)
	if drawings[player] then
		for _, obj in pairs(drawings[player]) do
			if typeof(obj) == "table" then
				for _, line in pairs(obj) do line:Remove() end
			else
				obj:Remove()
			end
		end
		drawings[player] = nil
	end
end

-- üîÅ –û—Ç—Ä–∏—Å–æ–≤–∫–∞ ESP –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä
rs.RenderStepped:Connect(function()
	if not espToggles.Enabled then
		for _, d in pairs(drawings) do
			d.Box.Visible = false
			d.Name.Visible = false
			for _, l in pairs(d.Lines) do l.Visible = false end
		end
		return
	end

	for _, plr in pairs(Players:GetPlayers()) do
		if plr ~= player and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") and plr.Character:FindFirstChild("Humanoid") and plr.Character.Humanoid.Health > 0 then
			createESP(plr)
			local hrp = plr.Character.HumanoidRootPart
			local pos, onscreen = camera:WorldToViewportPoint(hrp.Position)
			if onscreen then
				local size = Vector2.new(30, 60) -- –£—Å–ª–æ–≤–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–æ—Ä–æ–±–∫–∏
				local box = drawings[plr].Box
				box.Position = Vector2.new(pos.X - size.X / 2, pos.Y - size.Y / 2)
				box.Size = size
				box.Visible = espToggles.Box

				local name = drawings[plr].Name
				name.Position = Vector2.new(pos.X, pos.Y - 40)
				name.Text = plr.Name
				name.Visible = espToggles.Name

				-- –£–ø—Ä–æ—â—ë–Ω–Ω—ã–π Skeleton: HRP -> Head + 2 –Ω–æ–≥
				if espToggles.Skeleton then
					local head = plr.Character:FindFirstChild("Head")
					local l = drawings[plr].Lines
					if head then
						local hPos, hOn = camera:WorldToViewportPoint(head.Position)
						l[1].From = Vector2.new(pos.X, pos.Y)
						l[1].To = Vector2.new(hPos.X, hPos.Y)
						l[1].Visible = true
					end
					l[2].Visible = false
					l[3].Visible = false
				else
					for _, line in pairs(drawings[plr].Lines) do line.Visible = false end
				end
			else
				removeESP(plr)
			end
		end
	end
end)

-- üåê –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
local btn = Instance.new("TextButton", gui)
btn.Size = UDim2.new(0, 150, 0, 40)
btn.Position = UDim2.new(0, 20, 0, 100)
btn.Text = "ESP: OFF"
btn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
btn.TextColor3 = Color3.fromRGB(255, 255, 255)
btn.Font = Enum.Font.GothamBold
btn.TextSize = 16

btn.MouseButton1Click:Connect(function()
	espToggles.Enabled = not espToggles.Enabled
	btn.Text = "ESP: " .. (espToggles.Enabled and "ON" or "OFF")
end)

-- üîò –î–æ–ø. –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ (–º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ –º–µ–Ω—é)
uis.InputBegan:Connect(function(input, gpe)
	if gpe then return end
	if input.KeyCode == Enum.KeyCode.B then
		espToggles.Box = not espToggles.Box
	elseif input.KeyCode == Enum.KeyCode.N then
		espToggles.Name = not espToggles.Name
	elseif input.KeyCode == Enum.KeyCode.M then
		espToggles.Skeleton = not espToggles.Skeleton
	end
end)
